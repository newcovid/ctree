# ctree: 增强型命令行目录树工具

`ctree` 是一款为 Windows 命令行环境设计的目录树工具，旨在提供比原生 `tree` 命令更强大、更灵活的功能。

**项目开源地址：[https://github.com/newcovid/ctree](https://github.com/newcovid/ctree)**

*(注：项目代码和本文档的编写使用了 AI 辅助)*

---

## 目录

- [ctree: 增强型命令行目录树工具](#ctree-增强型命令行目录树工具)
  - [目录](#目录)
  - [引言](#引言)
  - [功能特性](#功能特性)
  - [使用截图](#使用截图)
  - [获取与安装](#获取与安装)
  - [使用方法](#使用方法)
    - [基本语法](#基本语法)
    - [参数选项](#参数选项)
    - [使用示例](#使用示例)
  - [系统集成](#系统集成)
    - [添加到环境变量 (推荐)](#添加到环境变量-推荐)
    - [替换原生 `tree` 命令 (可选，请谨慎操作)](#替换原生-tree-命令-可选请谨慎操作)
  - [贡献](#贡献)
  - [许可证](#许可证)

---

## 引言

Windows 系统自带的 `tree` 命令是查看目录结构的便捷工具，但在某些方面功能较为基础，特别是缺少对显示层级的直接控制（即 `-L` 参数）。为了解决这一痛点并提供更完善的用户体验，`ctree` 应运而生。项目初期目标是实现层级控制，后续逐步扩展，集成了更多实用特性，力求成为一款功能全面的目录结构分析工具。

---

## 功能特性

`ctree` 在兼容原生 `tree` 命令核心功能的基础上，进行了显著的功能增强与扩展，主要体现在以下几个方面：

* **层级控制 (`-L <层数>`)**：精确指定目录树的显示深度。
* **多样化的输出格式**：
    * **JSON 输出 (`-J`)**：便于程序化处理与数据集成。
    * **XML 输出 (`-X`)**：提供 XML 格式选项。
    * **文件输出 (`-o <文件名>`)**：结果可重定向至文件，默认 UTF-8 编码。
* **详尽的信息展示**：
    * **文件列表显示 (`/F` 或 `-f`)**：在所有输出模式下控制是否列出文件名。
    * **文件/目录大小显示 (`-s`, `--show-size`)**：展示条目大小，支持 `--si` (1000基数) 和默认 (1024基数)。目录大小为其内容总和。
    * **文件/目录属性显示 (`-p`, `--show-perms`)**：显示只读、隐藏、系统、存档、目录、链接、压缩、加密等属性。
    * **隐藏及系统文件显示 (`-a`)**：允许列出隐藏和系统文件。
* **高级过滤**：
    * **内容包含/排除 (`--include`, `--exclude`)**：使用通配符 (`*`, `?`) 定义过滤模式，支持 `--ignore-case` 忽略大小写。
* **用户体验优化**：
    * **控制台颜色高亮 (`-c`)** (文本模式)：不同类型条目以不同颜色显示。
    * **ASCII 线条 (`/A`, `--ascii`)**：兼容不支持扩展字符集的终端。
    * **统计报告**：默认输出目录与文件统计，可通过 `--noreport` 禁用。
    * **多语言支持**：帮助文档 (`-h`, `--help`) 提供中文及英文 (`--lang=en`)。

---

## 使用截图

**基本用法示例：**
![](/imgs/用法示例.png)

**帮助文档概览：**
![](/imgs/帮助文档.png)

---

## 获取与安装

1.  **下载预编译版本**：
    前往本项目的 [Releases 页面](https://github.com/newcovid/ctree/releases) (如果已创建) 下载最新的 `ctree.exe` 可执行文件。
2.  **自行编译**：
    克隆本仓库，并使用 C 编译器（如 GCC 或 MSVC，需配置好 Windows SDK）进行编译。
3.  **放置可执行文件**：
    将 `ctree.exe` 放置于您方便访问的任意目录。为了在任意路径下都能直接调用，建议将其所在目录添加到系统的 `PATH` 环境变量中（详见 [系统集成](#系统集成)）。

---

## 使用方法

### 基本语法

```bash
ctree [路径] [选项]
```

* `[路径]`：可选参数，指定要显示树状结构的目录。若省略，则默认为当前目录。
* `[选项]`：用于控制 `ctree` 行为的各种参数。

### 参数选项

详细的参数列表及其说明，请通过以下命令查看：

```bash
ctree -h
```
或者
```bash
ctree --help
```
英文帮助：
```bash
ctree --lang=en
```

主要参数已在 [功能特性](#功能特性) 部分列出。

### 使用示例

1.  **显示当前目录结构，最大深度为2层，包含文件列表及大小信息：**
    ```bash
    ctree . -L 2 -f -s
    ```

2.  **分析 "D:\Downloads" 目录，排除所有扩展名为 ".tmp" 的文件，并将结果以 JSON 格式保存至 "downloads_tree.json"：**
    ```bash
    ctree "D:\Downloads" --exclude "*.tmp" -J -o downloads_tree.json
    ```

3.  **显示当前目录下包含隐藏文件的结构，并使用 ASCII 字符集进行绘制：**
    ```bash
    ctree . -a --ascii
    ```

4.  **显示 "C:\Program Files" 目录的第一层，并以 SI 单位显示大小：**
    ```bash
    ctree "C:\Program Files" -L 1 -s --si
    ```

5.  **仅显示当前目录下的 ".c" 文件和目录，并排除 "build" 目录下的所有内容：**
    ```bash
    ctree . --include "*.c" --exclude "build/*"
    ```

---

## 系统集成

### 添加到环境变量 (推荐)

为了能够在任何路径下直接使用 `ctree` 命令，您可以将其所在的目录添加到系统的 `PATH` 环境变量中。

1.  找到 `ctree.exe` 文件所在的完整路径 (例如 `C:\Tools\ctree`)。
2.  打开系统环境变量设置：
    * 在 Windows 搜索中输入“环境变量”，选择“编辑系统环境变量”。
    * 在“系统属性”对话框的“高级”选项卡下，点击“环境变量(N)...”按钮。
3.  在“用户变量”或“系统变量”中找到名为 `Path` 的变量：
    * **用户变量**：仅对当前用户生效。
    * **系统变量**：对所有用户生效 (需要管理员权限)。
    * 通常建议修改用户的 `Path` 变量。
4.  选中 `Path` 变量，点击“编辑(E)...”。
5.  在“编辑环境变量”对话框中，点击“新建(N)”，然后粘贴 `ctree.exe` 所在的目录路径。
    ![](/imgs/环境变量展示1.png)
    ![](/imgs/环境变量展示2.png)
6.  逐级确定保存更改。重新打开一个新的命令行窗口后，即可直接输入 `ctree` 命令。

### 替换原生 `tree` 命令 (可选，请谨慎操作)

如果您希望使用 `ctree` 完全替代系统原生的 `tree.exe`，可以采取以下步骤：

1.  将 `ctree.exe` 重命名为 `tree.exe`。
2.  将其所在目录添加到 `PATH` 环境变量中。
3.  **关键步骤**：确保此目录在 `PATH` 变量中的顺序优先于系统目录 `%SystemRoot%\system32`。`PATH` 变量中的路径是按顺序搜索的，先找到的先生效。

**注意**：不推荐直接修改或替换 System32 目录下的系统文件。通过调整 `PATH` 环境变量的路径顺序是更安全的方式。通常情况下，建议将自定义工具目录添加到用户环境变量的 `Path` 中，这样 `ctree` (或重命名后的 `tree`) 和系统原生的 `tree` (如果需要通过完整路径调用) 可以并存。

---

## 贡献

欢迎对 `ctree` 项目做出贡献！您可以通过以下方式参与：

* 报告 Bug 或提出功能建议：请在 GitHub Issues 区提交。
* 提交代码：Fork 本仓库，创建您的特性分支，完成后提交 Pull Request。

---

## 许可证

该项目采用 [GPLv3](LICENSE)。

---
